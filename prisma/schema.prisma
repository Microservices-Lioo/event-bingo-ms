generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["relationJoins"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Event {
  id             String      @id @default(uuid())
  name           String
  description    String
  userId         String
  status         StatusEvent @default(PENDING)
  price          Float
  start_time     DateTime
  end_time       DateTime?
  host_is_active Boolean     @default(false)
  award          Award[]
  card           Card[]
  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt
}

model Award {
  id          String   @id @default(uuid())
  name        String
  description String
  gameId      String?
  event       Event    @relation(fields: [eventId], references: [id])
  eventId     String
  card        Card?    @relation(fields: [winner], references: [id])
  winner      String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Card {
  id        String   @id @default(uuid())
  buyer     String
  available Boolean  @default(true)
  nums      Json
  event     Event    @relation(fields: [eventId], references: [id])
  eventId   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  Award     Award[]

  @@index([available])
}

enum StatusEvent {
  PENDING
  ACTIVE
  CANCELLED
  COMPLETED
}
